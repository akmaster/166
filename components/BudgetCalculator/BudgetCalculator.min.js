!(function () {
  'use strict';
  let e = null;
  function t(t) {
    (document.getElementById('result-reward').textContent = t.formatted_reward),
      (document.getElementById('result-interval').textContent = t.formatted_interval),
      (document.getElementById('result-codes').textContent = t.codes_per_stream),
      (document.getElementById('result-participants').textContent = t.expected_participants),
      (document.getElementById('result-cost').textContent = t.formatted_cost),
      (document.getElementById('result-efficiency').textContent = t.efficiency + '%'),
      (document.getElementById('calculation-results').style.display = 'block');
  }
  document.getElementById('calculate-budget')?.addEventListener('click', function () {
    const e = parseFloat(document.getElementById('total_budget').value),
      n = parseFloat(document.getElementById('stream_hours').value),
      a = parseInt(document.getElementById('estimated_viewers').value),
      d = parseFloat(document.getElementById('participation_rate').value);
    if (isNaN(e) || e < 1 || e > 1e5) return void alert('BÃ¼tÃ§e: 1-100,000 TL arasÄ± olmalÄ±');
    if (isNaN(n) || n < 0.5 || n > 24) return void alert('YayÄ±n sÃ¼resi: 0.5-24 saat arasÄ± olmalÄ±');
    if (isNaN(a) || a < 1 || a > 1e5) return void alert('Ä°zleyici sayÄ±sÄ±: 1-100,000 arasÄ± olmalÄ±');
    if (isNaN(d) || d < 1 || d > 100) return void alert('KatÄ±lÄ±m oranÄ±: 1-100% arasÄ± olmalÄ±');
    const l = new FormData();
    l.append('total_budget', e),
      l.append('stream_hours', n),
      l.append('estimated_viewers', a),
      l.append('participation_rate', d),
      (this.disabled = !0),
      (this.textContent = 'ðŸ§® HesaplanÄ±yor...'),
      fetch('/api/calculate-budget.php', { method: 'POST', body: l })
        .then((e) => e.json())
        .then((n) => {
          n.success ? ((e = n.data), t(n.data)) : alert('Hata: ' + n.message),
            (this.disabled = !1),
            (this.textContent = 'ðŸ§® Hesapla');
        })
        .catch((e) => {
          alert('BaÄŸlantÄ± hatasÄ±'), (this.disabled = !1), (this.textContent = 'ðŸ§® Hesapla');
        });
  }),
    document.getElementById('apply-budget-settings')?.addEventListener('click', function () {
      if (!e) return void alert('Ã–nce hesaplama yapÄ±n');
      const t = new FormData();
      t.append('reward_amount', e.reward_amount),
        t.append('code_interval', e.interval),
        t.append('code_duration', e.suggested_duration),
        t.append('countdown_duration', e.suggested_countdown),
        (this.disabled = !0),
        (this.textContent = 'âœ… UygulanÄ±yor...'),
        fetch('/api/apply-budget-settings.php', { method: 'POST', body: t })
          .then((e) => e.json())
          .then((e) => {
            e.success
              ? (alert('Ayarlar baÅŸarÄ±yla uygulandÄ±! Sayfa yenilenecek.'), location.reload())
              : (alert('Hata: ' + e.message),
                (this.disabled = !1),
                (this.textContent = 'âœ… Bu AyarlarÄ± Uygula'));
          })
          .catch((e) => {
            alert('BaÄŸlantÄ± hatasÄ±'),
              (this.disabled = !1),
              (this.textContent = 'âœ… Bu AyarlarÄ± Uygula');
          });
    });
})();
